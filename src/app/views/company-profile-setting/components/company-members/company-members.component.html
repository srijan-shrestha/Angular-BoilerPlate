<div class="py-4 page-profile">
  <div class="py-4">
    <div class="row">
      <div class="col">
        <div class="row">
          <div class="col">
            <div class="">
              <div class="row pl-3">
                <h4 class="mb-2">Employee Directory Search</h4>
              </div>
              <div class="row">
                <div class="form-group col-md-5">
                  <label class="control-label">Employee Name</label>
                  <input type="text" value='' class="form-control border-radius-5" id="employee-name"
                         [(ngModel)]="employeeNameFilter" (blur)="filter()">
                </div>
                <div class="form-group col-md-5">
                  <label for="departments">Department</label>
                  <select id="departments" class="form-control border-radius-5" [(ngModel)]="departmentIdFilter"
                          (change)="filter()">
                    <option [value]="0">Select one</option>
                    <option *ngFor="let department of departments"
                            [value]="department.id">{{ department.name }}</option>
                  </select>
                </div>
                <div class="form-group col-md-2">
                  <div class="d-flex flex-column">
                    <button value='' class="btn btn-primary border-radius-5 apply-filter-button text-uppercase"
                            (click)="filter()">
                      Apply Filters
                      <app-icon type="white" icon="search"
                                class="sidebar__nav-icon ml-3 float-right search-icon"></app-icon>
                    </button>
                  </div>
                </div>

              </div>
              <div class="row">
                <div class="col">
                  <app-table [dataSource]="members" [noData]="'Employee not available.'"
                             size="lg"
                             [border]="true"
                             multiTemplateDataRows>
                    <ng-container cdkColumnDef="fullName">
                      <th appTableHeader cdk-header-cell *cdkHeaderCellDef
                          orderKey="fullName"
                          orderDir="asc"
                          currentOrder="fullName"
                          class="name-sort-head"
                          (ordered)="sort($event)"
                      >
                        <div class="full-name-position">
                          Name
                        </div>
                      </th>
                      <td cdk-cell *cdkCellDef="let row">
                        <div class="row pl-4">
                          <div class="profile-image avatar"
                               [style.backgroundImage]="'url(' + row?.profilePic + ')'"
                               *ngIf="row?.profilePic"></div>
                          <div class="profile-image avatar" *ngIf="!row?.profilePic"></div>
                          <div class="col-auto py-2 full-name-field pl-4">{{row?.fullName}}</div>
                          <p>
                        </div>
                        <div class="text-muted job-title job-title-field pl-4">{{ row?.profile?.jobTitle || '-' }}</div>
                      </td>
                    </ng-container>
                    <ng-container cdkColumnDef="department">
                      <th appTableHeader cdk-header-cell *cdkHeaderCellDef
                          orderKey="departmentName"
                          orderDir="asc"
                          currentOrder="departmentName"
                          class="department-head"
                          (ordered)="sort($event)"
                      >Department
                      </th>
                      <td cdk-cell *cdkCellDef="let row"
                          class="text-center-margin"> {{row?.departmentName || '-'}} </td>
                    </ng-container>
                    <ng-container cdkColumnDef="team">
                      <th appTableHeader cdk-header-cell *cdkHeaderCellDef
                          orderKey="teamName"
                          orderDir="asc"
                          currentOrder="teamName"
                          class="team-sort"
                          (ordered)="sort($event)"
                      >Team
                      </th>
                      <td cdk-cell *cdkCellDef="let row" class="text-center-margin">{{ row?.teamName || '-'}}</td>
                    </ng-container>
                    <ng-container cdkColumnDef="supervisor">
                      <th appTableHeader cdk-header-cell *cdkHeaderCellDef
                          orderKey="supervisorName"
                          orderDir="asc"
                          currentOrder="supervisorName"
                          class="department-head"
                          (ordered)="sort($event)">
                        Supervisor
                      </th>
                      <td cdk-cell *cdkCellDef="let row" class="text-center-margin">{{ row?.supervisorName || '-'}}</td>
                    </ng-container>
                    <ng-container cdkColumnDef="view">
                      <th appTableHeader cdk-header-cell *cdkHeaderCellDef>
                        <button type="button" class="btn btn-sm btn add-member-button"
                                (click)="openInviteMembersModal()"
                                *ngIf="role === 'company_admin' || role === 'super_admin'">
                          <span class="add-button-text"> + ADD MEMBER</span>
                        </button>
                      </th>
                      <td cdk-cell *cdkCellDef="let row">
                        <app-icon [icon]="viewDetail && employeeDetailId === row.id ? 'toggleUp' : 'toggleDown'"
                                  size="sm"
                                  type="gray"
                                  class="down-icon"
                                  [id]="'element' + row.id"
                                  (click)="viewEmployeeDetails(row.id)"
                        ></app-icon>
                      </td>
                    </ng-container>
                    <ng-container cdkColumnDef="employeeDetails">
                      <td cdk-cell *cdkCellDef="let row" [attr.colspan]="membersColumns.length">
                        <div *ngIf="viewDetail && employeeDetailId === row.id">
                          <div class="row p-4 collapsed-element">
                            <div class="card card-body">
                              <div class="row">
                                <div class="col-sm avatar-parent" id="relative-one">
                                  <div class="avatar-element">
                                    <img class="rounded-circle collapsed-avatar"
                                         [src]="row?.profilePic" *ngIf="row?.profilePic">
                                    <div class="rounded-circle collapsed-avatar-empty" *ngIf="!row?.profilePic"></div>

                                    <p></p>
                                    <h6>{{ row?.fullName || '-' }}</h6>
                                    {{ row?.profile?.jobTitle || '-' }}
                                    <!--<p><a href="#" class="add-button">PROFILE PAGE</a></p>-->
                                  </div>
                                </div>
                                <div class="col-sm">
                                  <div class="detail-heading">CONTACT</div>
                                  <hr>
                                  <div class="ml-2">
                                    <span class="text-muted info-heading">OFFICE</span>
                                    <br>
                                    {{ row?.company?.profile?.phoneNumber || '-' }}
                                    <p></p>
                                    <span class="text-muted info-heading">MOBILE</span>
                                    <br>
                                    {{ row?.mobile || '-' }}
                                    <p></p>
                                    <span class="text-muted info-heading">EMAIL</span>
                                    <br>
                                    {{row?.email || '-'}}
                                  </div>

                                </div>
                                <div class="col-sm">
                                  <div class="detail-heading">WORK DETAILS</div>
                                  <hr>
                                  <div class="ml-2">
                                    <span class="text-muted info-heading">DEPARTMENT</span><br>
                                    {{ row?.departmentName || '-' }}
                                    <p></p>
                                    <span class="text-muted info-heading">SUPERVISOR</span>
                                    <br>
                                    {{ row?.supervisorName || '-' }}
                                    <p></p>
                                    <span class="text-muted info-heading">OFFICE LOCATION</span>
                                    <br>
                                    {{ row?.company?.profile?.address1 || '-' }}
                                  </div>
                                </div>

                                <div class="col-sm">
                                  <div class="detail-heading">PERSONAL DETAILS</div>
                                  <hr>
                                  <div class="ml-2">
                                    <span class="text-muted info-heading">HIRE DATE</span>
                                    <br>
                                    {{ getMemberFormattedDate(row, 'profile', 'hiringDate') }}
                                    <p></p>
                                    <span class="text-muted info-heading">BIRTH DATE</span>
                                    <br>
                                    {{ getMemberFormattedDate(row, 'profile', 'birthDate') }}
                                    <p></p>
                                    <span class="text-muted info-heading">FROM</span>
                                    <br>
                                    {{ getPersonalAddress(row) }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="mt-3"></div>
                        </div>
                      </td>
                    </ng-container>
                    <tr cdk-header-row *cdkHeaderRowDef="membersColumns"></tr>
                    <tr cdk-row *cdkRowDef="let row; columns: membersColumns;" class="bg-white"></tr>
                    <tr cdk-row *cdkRowDef="let element; columns: ['employeeDetails']"
                        class="table__detail bg-white noBorder"></tr>
                  </app-table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
